[{"cmd": "SELECT", "qual": "true", "roles": ["public"], "tablename": "profiles", "policyname": "profiles_select_all", "with_check": null}, {"cmd": "UPDATE", "qual": "(auth.uid() = id)", "roles": ["public"], "tablename": "profiles", "policyname": "profiles_update_self", "with_check": "(auth.uid() = id)"}, {"cmd": "SELECT", "qual": "true", "roles": ["public"], "tablename": "session_templates", "policyname": "session_templates_select_all", "with_check": null}, {"cmd": "SELECT", "qual": "(auth.uid() IN ( SELECT profiles.id\n   FROM profiles\n  WHERE (profiles.role ~~* 'admin'::text)))", "roles": ["authenticated"], "tablename": "bookings", "policyname": "Admins can view all bookings", "with_check": null}, {"cmd": "SELECT", "qual": "true", "roles": ["public"], "tablename": "sessions", "policyname": "sessions_select_all", "with_check": null}, {"cmd": "SELECT", "qual": "((auth.uid() = customer_id) OR (auth.uid() IN ( SELECT s.instructor_id\n   FROM sessions s\n  WHERE (s.id = bookings.session_id))))", "roles": ["public"], "tablename": "bookings", "policyname": "bookings_select_own", "with_check": null}, {"cmd": "INSERT", "qual": null, "roles": ["public"], "tablename": "bookings", "policyname": "bookings_insert_any_authenticated", "with_check": "(auth.role() = 'authenticated'::text)"}, {"cmd": "SELECT", "qual": "(auth.uid() IN ( SELECT profiles.id\n   FROM profiles\n  WHERE (profiles.role ~~* 'admin'::text)))", "roles": ["authenticated"], "tablename": "sessions", "policyname": "Admins can view all sessions", "with_check": null}, {"cmd": "ALL", "qual": "(auth.uid() = instructor_id)", "roles": ["public"], "tablename": "availability_blocked_dates", "policyname": "availability_blocked_manage_own", "with_check": "(auth.uid() = instructor_id)"}, {"cmd": "SELECT", "qual": "(auth.uid() = user_id)", "roles": ["public"], "tablename": "notifications", "policyname": "notifications_read_own", "with_check": null}, {"cmd": "INSERT", "qual": null, "roles": ["public"], "tablename": "notifications", "policyname": "notifications_insert_any_authenticated", "with_check": "(auth.role() = 'authenticated'::text)"}, {"cmd": "SELECT", "qual": "true", "roles": ["public"], "tablename": "locations", "policyname": "locations_select_all", "with_check": null}, {"cmd": "SELECT", "qual": "true", "roles": ["public"], "tablename": "categories", "policyname": "categories_select_all", "with_check": null}, {"cmd": "DELETE", "qual": "is_admin()", "roles": ["authenticated"], "tablename": "locations", "policyname": "Admins can delete locations", "with_check": null}, {"cmd": "INSERT", "qual": null, "roles": ["authenticated"], "tablename": "categories", "policyname": "Admins can insert categories", "with_check": "is_admin()"}, {"cmd": "UPDATE", "qual": "is_admin()", "roles": ["authenticated"], "tablename": "categories", "policyname": "Admins can update categories", "with_check": null}, {"cmd": "DELETE", "qual": "is_admin()", "roles": ["authenticated"], "tablename": "categories", "policyname": "Admins can delete categories", "with_check": null}, {"cmd": "ALL", "qual": "is_admin()", "roles": ["authenticated"], "tablename": "sessions", "policyname": "Admins can manage all sessions", "with_check": "is_admin()"}, {"cmd": "ALL", "qual": "(auth.uid() = user_id)", "roles": ["public"], "tablename": "education_quiz_submissions", "policyname": "Users manage own submissions", "with_check": null}, {"cmd": "ALL", "qual": "(((auth.jwt() ->> 'email'::text) = 'contact@mroffbeat.com'::text) OR ((auth.jwt() ->> 'email'::text) = 'hanna@wezet.xyz'::text))", "roles": ["public"], "tablename": "education_quizzes", "policyname": "Admins full access quizzes", "with_check": null}, {"cmd": "SELECT", "qual": "(auth.uid() IN ( SELECT profiles.id\n   FROM profiles\n  WHERE (profiles.role ~~* 'admin'::text)))", "roles": ["authenticated"], "tablename": "products", "policyname": "Admins can view all products", "with_check": null}, {"cmd": "ALL", "qual": "(auth.uid() = instructor_id)", "roles": ["public"], "tablename": "session_templates", "policyname": "Instructors can manage own session_templates", "with_check": "(auth.uid() = instructor_id)"}, {"cmd": "ALL", "qual": "(auth.uid() = instructor_id)", "roles": ["public"], "tablename": "sessions", "policyname": "Instructors can manage own sessions", "with_check": "(auth.uid() = instructor_id)"}, {"cmd": "SELECT", "qual": "((is_active = true) OR is_admin())", "roles": ["public"], "tablename": "bundles", "policyname": "Public can view active bundles", "with_check": null}, {"cmd": "ALL", "qual": "is_admin()", "roles": ["public"], "tablename": "bundles", "policyname": "Admins can manage bundles", "with_check": null}, {"cmd": "UPDATE", "qual": "(EXISTS ( SELECT 1\n   FROM profiles\n  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::text))))", "roles": ["public"], "tablename": "platform_settings", "policyname": "platform_settings_update_admin", "with_check": "(EXISTS ( SELECT 1\n   FROM profiles\n  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::text))))"}, {"cmd": "SELECT", "qual": "true", "roles": ["public"], "tablename": "platform_settings", "policyname": "platform_settings_read_all", "with_check": null}, {"cmd": "INSERT", "qual": null, "roles": ["authenticated"], "tablename": "profiles", "policyname": "Admins can insert any profile", "with_check": "is_admin()"}, {"cmd": "SELECT", "qual": "(EXISTS ( SELECT 1\n   FROM bundles\n  WHERE ((bundles.id = bundle_items.bundle_id) AND ((bundles.is_active = true) OR is_admin()))))", "roles": ["public"], "tablename": "bundle_items", "policyname": "Public can view bundle items", "with_check": null}, {"cmd": "DELETE", "qual": "is_admin()", "roles": ["authenticated"], "tablename": "profiles", "policyname": "Admins can delete any profile", "with_check": null}, {"cmd": "UPDATE", "qual": "(( SELECT profiles_1.role\n   FROM profiles profiles_1\n  WHERE (profiles_1.id = auth.uid())) = 'admin'::text)", "roles": ["authenticated"], "tablename": "profiles", "policyname": "Admins can update any profile", "with_check": "(( SELECT profiles_1.role\n   FROM profiles profiles_1\n  WHERE (profiles_1.id = auth.uid())) = 'admin'::text)"}, {"cmd": "INSERT", "qual": null, "roles": ["authenticated"], "tablename": "locations", "policyname": "Admins can insert locations", "with_check": "is_admin()"}, {"cmd": "UPDATE", "qual": "is_admin()", "roles": ["authenticated"], "tablename": "locations", "policyname": "Admins can update locations", "with_check": null}, {"cmd": "ALL", "qual": "((auth.jwt() ->> 'email'::text) = ANY (ARRAY['hanna@wezet.xyz'::text, 'contact@mroffbeat.com'::text, 'pakosub@gmail.com'::text]))", "roles": ["authenticated"], "tablename": "session_templates", "policyname": "Super Admin Email Override", "with_check": "((auth.jwt() ->> 'email'::text) = ANY (ARRAY['hanna@wezet.xyz'::text, 'contact@mroffbeat.com'::text, 'pakosub@gmail.com'::text]))"}, {"cmd": "ALL", "qual": "is_admin()", "roles": ["public"], "tablename": "bundle_items", "policyname": "Admins can manage bundle items", "with_check": null}, {"cmd": "SELECT", "qual": "((auth.uid() = user_id) OR is_admin())", "roles": ["public"], "tablename": "bundle_purchases", "policyname": "Users can view own purchases", "with_check": null}, {"cmd": "SELECT", "qual": "true", "roles": ["public"], "tablename": "products", "policyname": "Products are viewable by everyone", "with_check": null}, {"cmd": "INSERT", "qual": null, "roles": ["public"], "tablename": "products", "policyname": "Admins can insert products", "with_check": "(EXISTS ( SELECT 1\n   FROM profiles\n  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::text))))"}, {"cmd": "UPDATE", "qual": "(EXISTS ( SELECT 1\n   FROM profiles\n  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::text))))", "roles": ["public"], "tablename": "products", "policyname": "Admins can update products", "with_check": null}, {"cmd": "DELETE", "qual": "(EXISTS ( SELECT 1\n   FROM profiles\n  WHERE ((profiles.id = auth.uid()) AND (profiles.role = 'admin'::text))))", "roles": ["public"], "tablename": "products", "policyname": "Admins can delete products", "with_check": null}, {"cmd": "INSERT", "qual": null, "roles": ["public"], "tablename": "bundle_purchases", "policyname": "Users can create pending purchases", "with_check": "(auth.uid() = user_id)"}, {"cmd": "UPDATE", "qual": "(is_admin() OR (auth.role() = 'service_role'::text))", "roles": ["public"], "tablename": "bundle_purchases", "policyname": "Service role or Admin can update purchases", "with_check": null}, {"cmd": "SELECT", "qual": "(auth.uid() = user_id)", "roles": ["public"], "tablename": "redemption_codes", "policyname": "Users can view own redemption codes", "with_check": null}, {"cmd": "ALL", "qual": "(auth.uid() = instructor_id)", "roles": ["authenticated"], "tablename": "availability_exceptions", "policyname": "Instructors can manage own availability_exceptions", "with_check": "(auth.uid() = instructor_id)"}, {"cmd": "SELECT", "qual": "is_admin()", "roles": ["public"], "tablename": "redemption_codes", "policyname": "Admins can view all redemption codes", "with_check": null}, {"cmd": "ALL", "qual": "(auth.uid() = instructor_id)", "roles": ["authenticated"], "tablename": "availability_rules", "policyname": "Instructors can manage own availability_rules", "with_check": "(auth.uid() = instructor_id)"}, {"cmd": "ALL", "qual": "is_app_admin()", "roles": ["authenticated"], "tablename": "availability_exceptions", "policyname": "Admins can manage all availability_exceptions", "with_check": "is_app_admin()"}, {"cmd": "ALL", "qual": "is_app_admin()", "roles": ["authenticated"], "tablename": "availability_rules", "policyname": "Admins can manage all availability_rules", "with_check": "is_app_admin()"}, {"cmd": "SELECT", "qual": "(is_published = true)", "roles": ["public"], "tablename": "education_courses", "policyname": "Public courses are viewable by everyone", "with_check": null}, {"cmd": "SELECT", "qual": "(auth.uid() = user_id)", "roles": ["public"], "tablename": "education_enrollments", "policyname": "Users can view own enrollments", "with_check": null}, {"cmd": "SELECT", "qual": "((EXISTS ( SELECT 1\n   FROM (education_modules m\n     JOIN education_enrollments e ON ((e.course_id = m.course_id)))\n  WHERE ((m.id = education_lessons.module_id) AND (e.user_id = auth.uid()) AND (e.status = 'active'::text)))) OR ((auth.jwt() ->> 'email'::text) ~~* '%admin%'::text) OR ((auth.jwt() ->> 'email'::text) = 'contact@mroffbeat.com'::text) OR ((auth.jwt() ->> 'email'::text) = 'hanna@wezet.xyz'::text))", "roles": ["public"], "tablename": "education_lessons", "policyname": "Enrolled users can view lessons", "with_check": null}, {"cmd": "ALL", "qual": "(auth.uid() = user_id)", "roles": ["public"], "tablename": "education_progress", "policyname": "Users manage their own progress", "with_check": null}, {"cmd": "ALL", "qual": "(((auth.jwt() ->> 'email'::text) = 'contact@mroffbeat.com'::text) OR ((auth.jwt() ->> 'email'::text) = 'hanna@wezet.xyz'::text))", "roles": ["public"], "tablename": "education_courses", "policyname": "Admins have full access courses", "with_check": null}, {"cmd": "ALL", "qual": "(((auth.jwt() ->> 'email'::text) = 'contact@mroffbeat.com'::text) OR ((auth.jwt() ->> 'email'::text) = 'hanna@wezet.xyz'::text))", "roles": ["public"], "tablename": "education_modules", "policyname": "Admins have full access modules", "with_check": null}, {"cmd": "ALL", "qual": "(((auth.jwt() ->> 'email'::text) = 'contact@mroffbeat.com'::text) OR ((auth.jwt() ->> 'email'::text) = 'hanna@wezet.xyz'::text))", "roles": ["public"], "tablename": "education_lessons", "policyname": "Admins have full access lessons", "with_check": null}, {"cmd": "ALL", "qual": "(((auth.jwt() ->> 'email'::text) = 'contact@mroffbeat.com'::text) OR ((auth.jwt() ->> 'email'::text) = 'hanna@wezet.xyz'::text))", "roles": ["public"], "tablename": "education_enrollments", "policyname": "Admins have full access enrollments", "with_check": null}, {"cmd": "SELECT", "qual": "true", "roles": ["public"], "tablename": "education_modules", "policyname": "Everyone can view modules", "with_check": null}, {"cmd": "INSERT", "qual": null, "roles": ["public"], "tablename": "bundle_purchases", "policyname": "Admins can assign bundles (insert)", "with_check": "is_admin()"}, {"cmd": "ALL", "qual": "is_app_admin()", "roles": ["authenticated"], "tablename": "session_templates", "policyname": "Admins can manage all session_templates", "with_check": "is_app_admin()"}, {"cmd": "SELECT", "qual": "true", "roles": ["authenticated"], "tablename": "profiles", "policyname": "RLS_PROFILES_SELECT_v3", "with_check": null}, {"cmd": "SELECT", "qual": "true", "roles": ["authenticated"], "tablename": "profiles", "policyname": "Anyone can view profiles", "with_check": null}, {"cmd": "UPDATE", "qual": "(auth.uid() = id)", "roles": ["authenticated"], "tablename": "profiles", "policyname": "RLS_PROFILES_UPDATE_v3", "with_check": null}, {"cmd": "SELECT", "qual": "((EXISTS ( SELECT 1\n   FROM ((education_lessons l\n     JOIN education_modules m ON ((m.id = l.module_id)))\n     JOIN education_enrollments e ON ((e.course_id = m.course_id)))\n  WHERE ((l.id = education_quizzes.lesson_id) AND (e.user_id = auth.uid()) AND (e.status = 'active'::text)))) OR ((auth.jwt() ->> 'email'::text) = 'contact@mroffbeat.com'::text) OR ((auth.jwt() ->> 'email'::text) = 'hanna@wezet.xyz'::text))", "roles": ["public"], "tablename": "education_quizzes", "policyname": "Enrolled users can view quizzes", "with_check": null}, {"cmd": "ALL", "qual": "is_admin()", "roles": ["authenticated"], "tablename": "profiles", "policyname": "RLS_PROFILES_ALL_ADMIN_v3", "with_check": null}, {"cmd": "SELECT", "qual": "((is_active = true) OR is_admin())", "roles": ["anon", "authenticated"], "tablename": "session_templates", "policyname": "RLS_SESSIONS_SELECT_v3", "with_check": null}, {"cmd": "ALL", "qual": "is_admin()", "roles": ["authenticated"], "tablename": "session_templates", "policyname": "RLS_SESSIONS_ALL_ADMIN_v3", "with_check": null}, {"cmd": "SELECT", "qual": "((auth.uid() = customer_id) OR is_admin())", "roles": ["authenticated"], "tablename": "bookings", "policyname": "RLS_BOOKINGS_SELECT_v3", "with_check": null}, {"cmd": "ALL", "qual": "is_admin()", "roles": ["authenticated"], "tablename": "bookings", "policyname": "RLS_BOOKINGS_ALL_ADMIN_v3", "with_check": null}]